INCLUDE( MacroExtractArchive )

SET ( CRIMILD_DEPENDENCY_BULLET_NAME bullet-2.82-r2704 )
SET ( CRIMILD_DEPENDENCY_BULLET_HOME ${CRIMILD_SOURCE_DIR}/third-party/${CRIMILD_DEPENDENCY_BULLET_NAME} )

# Extract lua sources if needed
EXTRACT_ARCHIVE( ${CRIMILD_DEPENDENCY_BULLET_NAME}.tgz ${CRIMILD_DEPENDENCY_BULLET_NAME} ${CRIMILD_SOURCE_DIR}/third-party )

EXECUTE_PROCESS( 
	COMMAND cmake 
	. -G "Unix Makefiles" 
	-DBUILD_EXTRAS=off -DBUILD_DEMOS=off 
	-DINSTALL_LIBS=on
	-DCMAKE_INSTALL_PREFIX=${CRIMILD_DEPENDENCY_BULLET_HOME}
	-DCMAKE_INSTALL_NAME_DIR=${CRIMILD_DEPENDENCY_BULLET_HOME}
	WORKING_DIRECTORY ${CRIMILD_DEPENDENCY_BULLET_HOME} )

EXECUTE_PROCESS( 
	COMMAND make all install
	WORKING_DIRECTORY ${CRIMILD_DEPENDENCY_BULLET_HOME} )

SET( CRIMILD_INCLUDE_DIRECTORIES 
	${CRIMILD_SOURCE_DIR}/core/src 
	${CRIMILD_DEPENDENCY_BULLET_HOME}/include/bullet )

SET( CRIMILD_LINK_DIRECTORIES 
	${CRIMILD_DEPENDENCY_BULLET_HOME}/lib
	${CRIMILD_LINK_DIRECTORIES} )

SET( CRIMILD_LIBRARY_LINK_LIBRARIES 
	crimild_core
	BulletCollision
	BulletDynamics
	LinearMath )

INCLUDE( ModuleBuildLibrary )
